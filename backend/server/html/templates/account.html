{{ template "head.html" . }}
<body>
{{ template "header.html" . }}
<div id="center-div">
  <h1>Account</h1>
  <hr class="accent-hr">
  <div>
    <table class="account-table">
      {{ if .EmailConfigured }}
      <tr>
        <td>
          <label class="slightly-bold-text">Email:</label>
        </td>
        <td>
          {{ if ne .Email "" }}
            <span>{{ .Email }}</span> — <a id="change-email" href="#">Change Email</a>
          {{ else }}
            <span>None</span> — <a id="set-email" href="#">Set Email</a>
          {{ end }}
        </td>
      </tr>
      {{ end }}
      <tr>
        <td>
          <label class="slightly-bold-text">Vault:</label>
        </td>
        <td>
          <span>{{ .StorageUsed }} / {{ .StorageAvailable }}</span>
        </td>
      </tr>
      <tr>
        <td>
          <label class="slightly-bold-text">Send:</label>
        </td>
        <td>
          <span>{{ .SendUsed }} / {{ .SendAvailable }} / month</span>
        </td>
      </tr>
      {{ if .Base.Config.BillingEnabled }}
      <tr>
        <td>
          <label class="slightly-bold-text">Upgrades:</label>
        </td>
        <td>
          {{ if .IsActive }}
          <span>Active (expires {{ .ExpString }})</span>
          {{ else if .IsPrevUpgraded }}
          <span>Expired {{ .ExpString }}</span>
          {{ else }}
          <span>Inactive</span>
          {{ end }}
        </td>
      </tr>
      {{ end }}
      {{ if ne .Email "" }}
      <tr>
        <td>
          <label class="slightly-bold-text">Password Hint:</label>
        </td>
        <td>
          {{ if .HasPasswordHint }}
          <span class="green-text">Enabled</span> — <a href="{{ .Base.Endpoints.ChangeHint }}">Update / Disable</a>
          {{ else }}
          <span class="red-text">Not Set</span> — <a href="{{ .Base.Endpoints.ChangeHint }}">Enable</a>
          {{ end }}
        </td>
      </tr>
      {{ end }}
      <tr>
        <td>
          <label class="slightly-bold-text">Two-Factor Auth:</label>
        </td>
        <td>
          {{ if .Has2FA }}
          <span class="green-text">Enabled</span> — <a id="disable-2fa" href="#">Disable</a>
          {{ else }}
          <span class="red-text">Not Set</span> — <a href="{{ .Base.Endpoints.TwoFactor }}">Enable</a>
          {{ end }}
        </td>
      </tr>
    </table>
    <button id="change-pw-btn">Change Password</button> <button data-testid="logout-btn" id="logout-btn">Log Out</button>
    <details>
      <summary data-testid="advanced-summary">Advanced</summary>
      <table>
        <tr>
          <td class="slightly-bold-text">Payment ID:</td>
          <td>{{ .PaymentID }} — <a id="recycle-payment-id" href="#">Recycle</a></td>
        </tr>
      </table>
      <br>
      <button data-testid="delete-btn" id="delete-btn" class="red-button">Delete Account</button>
    </details>
  </div>
  <script src="/static/js/messages.js"></script>
  {{ if ne .ErrorMessage "" }}
  <div class="important-message" id="messages">
    <hr>
    <p id="error-message">{{ .ErrorMessage }}</p>
    <p id="success-message"></p>
  </div>
  {{ else if ne .SuccessMessage "" }}
  <div class="important-message" id="messages">
    <hr>
    <p id="error-message"></p>
    <p id="success-message">{{ .SuccessMessage }}</p>
  </div>
  {{ else }}
  <div id="messages">
    <hr>
    <p id="error-message"></p>
    <p id="success-message"></p>
  </div>
  {{ end }}
  {{ if or .Base.Config.StripeEnabled .Base.Config.BTCPayEnabled }}
    <hr>
    <div class="upgrade-container">
      <h1>Upgrades</h1>
      <div class="radio-group">
        <input type="radio" id="monthly-option" name="options" {{ if not .IsYearly }}checked{{ end }}>
        <label id="monthly-toggle" for="monthly-option"><a href="{{ .Base.Endpoints.Account }}">Monthly</a></label>
        <input type="radio" id="yearly-option" name="options" {{ if .IsYearly }}checked{{ end }}>
        <label id="yearly-toggle" for="yearly-option"><a href="{{ .Base.Endpoints.Account }}?yearly=1">Yearly (2 months free)</a></label>
      </div>
    </div>
    {{ if .Base.Config.BillingEnabled }}
      <div id="upgrade-div">
          {{ range $i, $prod := .Products }}
            <div class="pricing-box col-{{$i}}">
              <h3>{{ $prod.Name }}</h3>
              <ul>
                <li>{{ $prod.StorageGB }}GB vault storage</li>
                <li>{{ $prod.SendGB }}GB/month send</li>
                <li>Unlimited password storage</li>
              </ul>

              {{ if $.IsYearly }}
              <span><b>${{ $prod.Price }} per year</b></span>
              {{ else }}
              <span><b>${{ $prod.Price }} per month</b></span>
              {{ end }}
              <br>

              {{ if $.IsYearly }}
              <label for="quantity">Years:</label>
              {{ else }}
              <label for="quantity">Months:</label>
              {{ end }}
              <input class="quantity-input" type="number" id="quantity" value="1" max="12" min="1">

              {{ if $.Base.Config.StripeEnabled }}
              <a href="{{ $.BillingEndpoints.StripeCheckout }}?type={{ $prod.Tag }}&quantity=1">
                <button class="stripe-btn payment-btn">Purchase</button>
              </a><br>
<!--              <a href="{{ $.BillingEndpoints.StripeCheckout }}?type={{ $prod.Tag }}&autorenew=1">-->
<!--                <button class="stripe-btn payment-btn">Subscribe</button>-->
<!--              </a><br>-->
              {{ end }}
              {{ if $.Base.Config.BTCPayEnabled }}
                {{ if ne $prod.BTCPayLink "" }}
                  <a href="{{ $.BillingEndpoints.BTCPayCheckout }}?type={{ $prod.Tag }}&quantity=1">
                    {{ template "btcpay-button.html" }}
                  </a>
                {{ end }}
              {{ end }}
            </div>
          {{ end }}
        </div>
        {{ end }}
    <br>
    <span class="italic">Note: Payments are one-time payments and do not auto-renew.</span>
    {{ end }}
</div>

{{ template "two-factor-dialog.html" }}

{{ template "footer.html" . }}
</body>