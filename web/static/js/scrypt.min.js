/* https://github.com/ricmoo/scrypt-js */
"use strict";!function($){function f($){let f=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),_=1779033703,e=3144134277,x=1013904242,t=2773480762,n=1359893119,c=2600822924,r=528734635,o=1541459225,a=new Uint32Array(64);function l($){let l=0,u=$.length;for(;u>=64;){let i=_,b=e,s=x,h=t,p=n,d=c,w=r,g=o,y,m,k,N,v;for(m=0;m<16;m++)k=l+4*m,a[m]=(255&$[k])<<24|(255&$[k+1])<<16|(255&$[k+2])<<8|255&$[k+3];for(m=16;m<64;m++)N=((y=a[m-2])>>>17|y<<15)^(y>>>19|y<<13)^y>>>10,v=((y=a[m-15])>>>7|y<<25)^(y>>>18|y<<14)^y>>>3,a[m]=(N+a[m-7]|0)+(v+a[m-16]|0)|0;for(m=0;m<64;m++)N=(((p>>>6|p<<26)^(p>>>11|p<<21)^(p>>>25|p<<7))+(p&d^~p&w)|0)+(g+(f[m]+a[m]|0)|0)|0,v=((i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10))+(i&b^i&s^b&s)|0,g=w,w=d,d=p,p=h+N|0,h=s,s=b,b=i,i=N+v|0;_=_+i|0,e=e+b|0,x=x+s|0,t=t+h|0,n=n+p|0,c=c+d|0,r=r+w|0,o=o+g|0,l+=64,u-=64}}l($);let u,i=$.length%64,b=$.length/536870912|0,s=$.length<<3,h=i<56?56:120,p=$.slice($.length-i,$.length);for(p.push(128),u=i+1;u<h;u++)p.push(0);return p.push(b>>>24&255),p.push(b>>>16&255),p.push(b>>>8&255),p.push(b>>>0&255),p.push(s>>>24&255),p.push(s>>>16&255),p.push(s>>>8&255),p.push(s>>>0&255),l(p),[_>>>24&255,_>>>16&255,_>>>8&255,_>>>0&255,e>>>24&255,e>>>16&255,e>>>8&255,e>>>0&255,x>>>24&255,x>>>16&255,x>>>8&255,x>>>0&255,t>>>24&255,t>>>16&255,t>>>8&255,t>>>0&255,n>>>24&255,n>>>16&255,n>>>8&255,n>>>0&255,c>>>24&255,c>>>16&255,c>>>8&255,c>>>0&255,r>>>24&255,r>>>16&255,r>>>8&255,r>>>0&255,o>>>24&255,o>>>16&255,o>>>8&255,o>>>0&255]}function _($,_,e){$=$.length<=64?$:f($);let x=64+_.length+4,t=Array(x),n=Array(64),c,r=[];for(c=0;c<64;c++)t[c]=54;for(c=0;c<$.length;c++)t[c]^=$[c];for(c=0;c<_.length;c++)t[64+c]=_[c];for(c=x-4;c<x;c++)t[c]=0;for(c=0;c<64;c++)n[c]=92;for(c=0;c<$.length;c++)n[c]^=$[c];function o(){for(let $=x-1;$>=x-4;$--){if(t[$]++,t[$]<=255)return;t[$]=0}}for(;e>=32;)o(),r=r.concat(f(n.concat(f(t)))),e-=32;return e>0&&(o(),r=r.concat(f(n.concat(f(t))).slice(0,e))),r}function e($,f,_,e,x){let r;for(c($,(2*_-1)*16,x,0,16),r=0;r<2*_;r++)n($,16*r,x,16),t(x,e),c(x,0,$,f+16*r,16);for(r=0;r<_;r++)c($,f+32*r,$,16*r,16);for(r=0;r<_;r++)c($,f+(2*r+1)*16,$,(r+_)*16,16)}function x($,f){return $<<f|$>>>32-f}function t($,f){c($,0,f,0,16);for(let _=8;_>0;_-=2)f[4]^=x(f[0]+f[12],7),f[8]^=x(f[4]+f[0],9),f[12]^=x(f[8]+f[4],13),f[0]^=x(f[12]+f[8],18),f[9]^=x(f[5]+f[1],7),f[13]^=x(f[9]+f[5],9),f[1]^=x(f[13]+f[9],13),f[5]^=x(f[1]+f[13],18),f[14]^=x(f[10]+f[6],7),f[2]^=x(f[14]+f[10],9),f[6]^=x(f[2]+f[14],13),f[10]^=x(f[6]+f[2],18),f[3]^=x(f[15]+f[11],7),f[7]^=x(f[3]+f[15],9),f[11]^=x(f[7]+f[3],13),f[15]^=x(f[11]+f[7],18),f[1]^=x(f[0]+f[3],7),f[2]^=x(f[1]+f[0],9),f[3]^=x(f[2]+f[1],13),f[0]^=x(f[3]+f[2],18),f[6]^=x(f[5]+f[4],7),f[7]^=x(f[6]+f[5],9),f[4]^=x(f[7]+f[6],13),f[5]^=x(f[4]+f[7],18),f[11]^=x(f[10]+f[9],7),f[8]^=x(f[11]+f[10],9),f[9]^=x(f[8]+f[11],13),f[10]^=x(f[9]+f[8],18),f[12]^=x(f[15]+f[14],7),f[13]^=x(f[12]+f[15],9),f[14]^=x(f[13]+f[12],13),f[15]^=x(f[14]+f[13],18);for(let e=0;e<16;++e)$[e]+=f[e]}function n($,f,_,e){for(let x=0;x<e;x++)_[x]^=$[f+x]}function c($,f,_,e,x){for(;x--;)_[e++]=$[f++]}function r($){if(!$||"number"!=typeof $.length)return!1;for(let f=0;f<$.length;f++){let _=$[f];if("number"!=typeof _||_%1||_<0||_>=256)return!1}return!0}function o($,f){if("number"!=typeof $||$%1)throw Error("invalid "+f);return $}function a($,f,x,t,a,l,u){if(x=o(x,"N"),t=o(t,"r"),a=o(a,"p"),l=o(l,"dkLen"),0===x||(x&x-1)!=0)throw Error("N must be power of 2");if(x>2147483647/128/t)throw Error("N too large");if(t>2147483647/128/a)throw Error("r too large");if(!r($))throw Error("password must be an array or buffer");if($=Array.prototype.slice.call($),!r(f))throw Error("salt must be an array or buffer");f=Array.prototype.slice.call(f);let i=_($,f,128*a*t),b=new Uint32Array(32*a*t);for(let s=0;s<b.length;s++){let h=4*s;b[s]=(255&i[h+3])<<24|(255&i[h+2])<<16|(255&i[h+1])<<8|(255&i[h+0])<<0}let p=new Uint32Array(64*t),d=new Uint32Array(32*t*x),w=32*t,g=new Uint32Array(16),y=new Uint32Array(16),m=a*x*2,k=0,N=null,v=!1,L=0,S=0,j,q,z=u?parseInt(1e3/t):4294967295,A="undefined"!=typeof setImmediate?setImmediate:setTimeout,B=function(){if(v)return u(Error("cancelled"),k/m);let f;switch(L){case 0:c(b,q=32*S*t,p,0,w),L=1,j=0;case 1:(f=x-j)>z&&(f=z);for(let r=0;r<f;r++)c(p,0,d,(j+r)*w,w),e(p,w,t,g,y);if(j+=f,k+=f,u){let o=parseInt(1e3*k/m);if(o!==N){if(v=u(null,k/m))break;N=o}}if(j<x)break;j=0,L=2;case 2:(f=x-j)>z&&(f=z);for(let s=0;s<f;s++){let h=(2*t-1)*16,C=p[h]&x-1;n(d,C*w,p,w),e(p,w,t,g,y)}if(j+=f,k+=f,u){let D=parseInt(1e3*k/m);if(D!==N){if(v=u(null,k/m))break;N=D}}if(j<x)break;if(c(p,0,b,q,w),++S<a){L=0;break}i=[];for(let E=0;E<b.length;E++)i.push(b[E]>>0&255),i.push(b[E]>>8&255),i.push(b[E]>>16&255),i.push(b[E]>>24&255);let F=_($,i,l);return u&&u(null,1,F),F}u&&A(B)};if(!u)for(;;){let C=B();if(void 0!=C)return C}B()}let l={scrypt:function($,f,_,e,x,t,n){return new Promise(function(c,r){let o=0;n&&n(0),a($,f,_,e,x,t,function($,f,_){if($)r($);else if(_)n&&1!==o&&n(1),c(new Uint8Array(_));else if(n&&f!==o)return o=f,n(f)})})},syncScrypt:function($,f,_,e,x,t){return new Uint8Array(a($,f,_,e,x,t))}};"undefined"!=typeof exports?module.exports=l:"function"==typeof define&&define.amd?define(l):$&&($.scrypt&&($._scrypt=$.scrypt),$.scrypt=l)}(this);
